/* passwordEntropy.js - http://code.xero.nu/passwordEntropy.js - (cc) xero harrison MMXIII http://creativecommons.org/licenses/by-sa/3.0/ */
(function(e){e.fn.passwordEntropy=function(t){var n=e.extend({display:"#results",colorize:true,showBits:true,strengths:["very-weak","weak","medium","strong","very-strong"]},t);return this.each(function(){e(this).bind("keyup",function(){var t,r,i,s,o,u,a=0,f=0,l=0,c=0,h,p,d,v,m,g;t=e(this).val();r=t.length;i=t.match(/[a-z]/)?t.match(/[a-z]/g).length:0;s=t.match(/[A-Z]/)?t.match(/[A-Z]/g).length:0;o=t.match(/[0-9]/)?t.match(/[0-9]/g).length:0;u=r-(i+s+o);if(s>0){a=26-s+s}if(i>0){f=26-i+i}if(o>0){l=10-o+o}if(u>0){c=33-u+u}h=a+f+l+c;p=h.toFixed(2);d=r.toFixed(2);v=(d*Math.log(p)/Math.log(2)).toFixed(0);if(isNaN(v)){v=0}if(v>=75){m=4}else if(v>=50){m=3}else if(v>=25){m=2}else if(v>=5){m=1}else{m=0}if(n.colorize){e(n.display).removeClass(n.strengths.join(" ")).addClass(n.strengths[m])}e(n.display).html(n.showBits?v+" bits = "+n.strengths[m].replace("-"," "):n.strengths[m].replace("-"," "))})})}})(jQuery)